---
title: "Morphometrics"
author: "Kaija Gahm"
date: "11/21/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Setup
## Load libraries
```{r, echo = FALSE}
source("libraries.R")
```

## Load data
```{r}
load("data/outputs/burst_stats.Rda")
read.csv("data/inputs/Combined_2019RespData_20190729.csv") # manual morphometrics
tpsfiles <- list.files("2019_PostResp_photos/Exposure_Edit/for_landmarks/", pattern = "*[[:digit:]].tps", full.names = T)
tpslist <- lapply(tpsfiles, readland.tps, specID = "imageID") # geometric landmarks
```

## Clean data
### Bind into one array and change dimnames
```{r}
landmarks <- abind(tpslist) # bind all sets of landmarks into one array

tadpoles_full <- dimnames(landmarks)[[3]]

tadpoles <- str_extract(tadpoles_full, pattern = "(?<=straightened\\_).*(?=\\_CH)")
dimnames(landmarks)[[3]] <- tadpoles
```

### Check for missing data
```{r}
any(is.na(landmarks)) # NICE
```

## Analysis
### Generalized Procrustes Analysis
```{r}
gpa <- gpagen(A = landmarks)
plot(gpa)
```

